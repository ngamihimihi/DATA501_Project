% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/e_step_nvnorm_mc.R
\name{e_step_nvnorm_mcem}
\alias{e_step_nvnorm_mcem}
\title{Monte Carlo E-step for Multivariate Normal (Random Walk Metropolis-Hastings)}
\usage{
e_step_nvnorm_mcem(data, params, m = 200, burn = 100, thin = 1, tau = 0.1)
}
\arguments{
\item{data}{A numeric matrix with missing values (NAs).}

\item{params}{A list containing:
\describe{
\item{mu}{A numeric vector of means.}
\item{sigma}{A positive definite covariance matrix.}
}}

\item{m}{Integer. Number of MCMC samples to draw (default is 200).}

\item{burn}{Integer. Number of burn-in iterations (default is 100).}

\item{thin}{Integer. Thinning factor to reduce autocorrelation (default is 1).}

\item{tau}{Numeric. Proposal variance scaling factor (default is 0.1).}
}
\value{
A list with:
\describe{
\item{imputed}{Numeric matrix of the same dimension as \code{data}, with missing
values imputed using Monte Carlo estimates of the conditional expectation. The
attribute \code{"mc_accept_rate"} stores the mean acceptance rate of the MCMC sampler.}
\item{accept_rate}{Vector of acceptance rates for each row.}
}
}
\description{
Performs the E-step of the Monte Carlo EM (MCEM) algorithm for missing data
under a multivariate normal model using Random Walk Metropolis-Hastings (RW-MH).
}
\details{
This function implements a Random Walk Metropolis-Hastings sampler
to approximate the conditional expectations in the E-step of the MCEM algorithm.
It is useful when analytic imputation is intractable or when estimating
uncertainty from the posterior distribution of missing values.
}
\examples{
data <- matrix(c(5.1, NA, 6.1,
                 1.0, 1.4, 4.3,
                 NA, 2.2, 2.5,
                 3.3, 1.1, 1.0), ncol = 3, byrow = TRUE)
mu <- colMeans(data, na.rm = TRUE)
sigma <- diag(3)
params <- list(mu = mu, sigma = sigma)
result <- e_step_nvnorm_mc(data, params, m = 50, burn = 50, thin = 1, tau = 0.1)
result$imputed
attr(result$imputed, "mc_accept_rate")
}
\seealso{
\code{\link{e_step_nvnorm}}, \code{\link{run_em_algorithm}}
}
